(function(e){function t(t){for(var o,r,s=t[0],l=t[1],c=t[2],p=0,d=[];p<s.length;p++)r=s[p],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&d.push(i[r][0]),i[r]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);u&&u(t);while(d.length)d.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(o=!1)}o&&(a.splice(t--,1),e=r(r.s=n[0]))}return e}var o={},i={index:0},a=[];function r(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"0f6c":function(e,t,n){"use strict";n("3169")},3169:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("POC")],1)},a=[],r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"max"},[n("div",{staticClass:"max map",attrs:{id:"Map"}}),e.povMode?n("ThreeBox360",{attrs:{pov:e.pov,type:e.type,pocId:e.pocPoInd,mask:e.mask,maska:e.maska,maskb:e.maskb,offSet:180,d:e.d,h:e.h,lineOff:e.lineOff}}):e._e(),n("div",{attrs:{id:"GUI"}})],1)},s=[],l=(n("c975"),n("d81d"),n("b0c0"),n("9315")),c=n.n(l),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{style:e.style,attrs:{id:"ThreeBox360"}})},p=[],d=(n("99af"),Math.PI/180),h={name:"ThreeBox360",props:["pov","offSet","type","pocId","mask","maska","maskb","d","h","lineOff"],data:function(){return{sphereMaterial:null,texture:null,scene:null,ellipseGeometry:null,ellipse:null}},computed:{heading:function(){var e,t=(null===(e=this.pov)||void 0===e?void 0:e.heading)||0;return t+this.offSet},pitch:function(){var e,t=((null===(e=this.pov)||void 0===e?void 0:e.pitch)||0)+90;return 180-t},r:function(){return this.heading*d},x:function(){return Math.sin(this.pitch*d)*Math.cos(this.heading*d)},z:function(){return Math.sin(this.pitch*d)*Math.sin(this.heading*d)},y:function(){return Math.cos(this.pitch*d)},box:function(){return 20!=this.type&&100!=this.type||-1===this.pocId?null:v[this.type][this.pocId]},style:function(){return this.mask?"-webkit-mask: linear-gradient(transparent 0%, transparent ".concat(this.maska,"%, #000  ").concat(this.maskb,"%, #000 100%);"):""}},watch:{box:function(e,t){t&&this.scene.remove(t),e&&this.scene.add(e)},d:function(e){var t=new f.EllipseCurve(0,0,e,e,0,2*Math.PI,!1,0),n=t.getPoints(500);this.ellipseGeometry.setFromPoints(n)},h:function(e){this.ellipse.position.y=-e},lineOff:function(e){this.ellipse.visible=e}},mounted:function(){var e=window.THREE,t=new e.Scene;this.scene=t;var n=new e.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e3);n.position.set(0,0,0);var o=1,i=0;n.lookAt(new e.Vector3(i,0,o)),n.setFocalLength(17.5);var a=new e.WebGLRenderer({antialias:!0,alpha:!0,premultipliedAlpha:!1});a.setSize(window.innerWidth,window.innerHeight),document.getElementById("ThreeBox360").appendChild(a.domElement);var r=new e.EllipseCurve(0,0,this.d,this.d,0,2*Math.PI,!1,0),s=r.getPoints(500),l=(new e.BufferGeometry).setFromPoints(s);this.ellipseGeometry=l;var c=new e.LineBasicMaterial({color:16711680}),u=new e.Line(l,c);this.ellipse=u,u.rotateX(Math.PI/2),u.position.y=-this.h,t.add(u);var p=this;function d(){requestAnimationFrame(d);var o=p.x,i=p.y,r=p.z;n.lookAt(new e.Vector3(o,i,r)),a.render(t,n)}d()}},f=window.THREE,v=m();function m(){for(var e=[],t=0;t<=6;t++)e.push(g(20,t));for(var n=[],o=0;o<=6;o++)n.push(g(100,o));return{20:e,100:n}}function g(e,t){var n=w("".concat(e,"/v").concat(t,"-").concat(e)),o=new f.MeshFaceMaterial(n),i=new f.BoxGeometry(500,500,500,1,1,1,n);return i.scale(-1,1,1),new f.Mesh(i,o)}function w(e){var t=[];return t.push(y("".concat(e,"/0.png"))),t.push(y("".concat(e,"/180.png"))),t.push(y()),t.push(y()),t.push(y("".concat(e,"/270.png"))),t.push(y("".concat(e,"/90.png"))),t}function y(e){return new f.MeshBasicMaterial({map:e?new f.ImageUtils.loadTexture(e):new f.ImageUtils.loadTexture("null.png"),transparent:!0,side:f.FrontSide})}var b=h,M=(n("5ec4"),n("2877")),P=Object(M["a"])(b,u,p,!1,null,"ac5d3136",null),k=P.exports,x=[{lat:25.03985197817485,lng:121.5540764656993},{lat:25.03979412243429,lng:121.5540791658423},{lat:25.03970062943005,lng:121.554077510916},{lat:25.03960977780449,lng:121.5540787303354},{lat:25.03952354047871,lng:121.5540796013493},{lat:25.0394436353457,lng:121.5540807336673},{lat:25.03938961172279,lng:121.5540809078701}],O={name:"GoogleBoxPoc",components:{ThreeBox360:k},data:function(){return{map:null,pov:null,povMode:!1,type:100,pocPoInd:0,mask:!1,maska:50,maskb:80,lineOff:!0,d:3,h:1}},mounted:function(){var e=this,t={lat:25.03985197817485,lng:121.5540764656993},n={center:t,zoom:14,fullscreenControl:!1,scrollwheel:!1};this.map=new window.google.maps.Map(document.getElementById("Map"),n);var o=this.map.getStreetView();o.setOptions({clickToGo:!1,panControl:!1}),o.addListener("visible_changed",(function(){e.povMode=o.visible})),o.addListener("position_changed",(function(){var t={lat:o.getPosition().lat(),lng:o.getPosition().lng()};e.pov=o.getPov(),e.pocPoInd=I(t),console.log("#position_changed",t,e.pov,e.pocPoInd)})),o.addListener("pov_changed",(function(){e.pov=o.getPov()})),o.setPosition(t),o.setVisible(!0);var i=window.dat,a=new i.GUI({name:"街景合成"});a.add(this,"type",{"20M":20,"100M":100}).name("裁切距離");var r=a.addFolder("遮罩設定");r.add(this,"mask",!1).name("遮罩"),r.add(this,"maska",0,80).name("遮罩上方界限"),r.add(this,"maskb",40,100).name("遮罩下方界限");var s=a.addFolder("距離補助線");s.add(this,"lineOff").name("可見"),s.add(this,"d",1,50).name("範圍"),s.add(this,"h",0,10).name("離地高")}};function I(e){var t=e.lat;return c()(x).pluck("lat").indexOf(t)}var _=O,T=(n("0f6c"),Object(M["a"])(_,r,s,!1,null,null,null)),j=T.exports,B={name:"App",components:{POC:j}},E=B,S=(n("034f"),Object(M["a"])(E,i,a,!1,null,null,null)),C=S.exports;o["a"].config.productionTip=!1,new o["a"]({render:function(e){return e(C)}}).$mount("#app")},"5ec4":function(e,t,n){"use strict";n("7e62")},"7e62":function(e,t,n){},"85ec":function(e,t,n){}});